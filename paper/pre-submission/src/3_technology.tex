\chapter{基盤技術}
\label{technology}
本章では、提案するシステムで用いる基盤技術について紹介する。

\section{デジタル証明書と構成技術}
本節では、本研究におけるデジタル証明書の定義と、その構成技術について解説する。
\subsection{デジタル証明書}
通常、デジタル証明書は公開鍵と公開鍵の所有者を紐づけ、公開鍵の真正性を示す証明書を指すことが一般的だが、本研究では、ある主体に対する証明書発行者の主張を表現したデジタルデータと定義する。
これらの主張には身分証明に関する個人情報から資格情報、ひいては大学の成績など多様な情報が含むことができ、デジタル証明書はこれらの情報を電子的に表現した上で第三者に対する提示・検証を可能とするための手段である。
一般的に、デジタル証明書は以下のような要素を持つ。
\begin{itemize}
    \item 発行者情報：デジタル証明書の発行者を識別するための情報
    \item 証明書の主体：証明書の主張の対象となる主体を識別するための情報
    \item 主張内容：発行者が証明書の主体について主張するなんらかの情報
    \item 有効期限：証明書の有効期限に関する情報
    \item 改ざんされていないことの証明：証明書が改ざんされていないことを示すための情報
\end{itemize}
これらの要素はデジタル証明書のデータモデルに従い表現され、様々な標準化団体が多様なデータモデルを提案している。
その一例である、W3CによるVerifiable Credentials Data Modelについては後述する。
また、デジタル証明書はシリアライズされてデジタルデータに変換されるが、代表的なシリアライズ形式としてはJSON, CBORなどがある。
\subsection{暗号学的ハッシュ関数}
ハッシュ関数とは、任意の長さのデータから要約された値（ハッシュ値）を得る関数であり、特に暗号や情報セキュリティの用途に適した性質を持つものを暗号学的ハッシュ関数と呼ぶ。
同じ入力値からは常に同じハッシュ値を得られ、またハッシュ値から入力値を計算することは困難であるという性質がある。
後述する公開鍵暗号やデジタル署名でも用いられている技術であり、以下の特性を持つ。
\begin{itemize}
    \item 原像計算困難性：ハッシュ値から元の入力値を計算することが困難である
    \item 弱衝突耐性：ある入力値とハッシュ値のペアがあったとき、同じハッシュ値を持つ異なる入力値を計算することが困難である
    \item 強衝突耐性：同じハッシュ値を持つ2つの異なる入力値のペアを計算することが困難である
\end{itemize}
なお代表的な暗号学的ハッシュ関数としては、SHA-256などが挙げられる。
\subsection{公開鍵暗号}
公開鍵暗号は、暗号化と復号で異なる2つの鍵を使用する暗号方式である。
2つの鍵はそれぞれ秘密鍵と公開鍵と呼ばれ、秘密鍵はその所有者によって秘密を保って管理される鍵であり、秘密鍵と対になる公開鍵は広く公開され、他人が利用可能な鍵である。
公開鍵暗号は広く用いられており、例えばインターネット上の通信を保護するためのプロトコルであるSSL/TLSで利用されている。
公開鍵暗号の代表的なアルゴリズムとしては、RSA(Rivest-Shamir-Adleman)、DSA(Digital Signature Algorithm)、ECDSA(Elliptic Curve Digital Signature Algorithm)などが挙げられる。
\subsection{デジタル署名}
デジタル署名は、あるデジタルデータが特定の主体により作成されたこと、かつ作成されたのちに改ざんされていないことを検証可能にするための技術である。
デジタル署名は、以下のプロセスで作成・検証される。
\begin{itemize}
    \item 作成プロセス
    \begin{enumerate}
        \item ハッシュ値の計算：署名者は、署名したいデータからハッシュ値を計算する
        \item 秘密鍵による署名：計算されたハッシュ値に対して、署名者の秘密鍵を使用して署名を生成する。この生成された値がデジタル署名となる
    \end{enumerate}
    \item 検証プロセス
    \begin{enumerate}
        \item 公開鍵の入手：まず、検証者は署名者の公開鍵を入手する。通常、公開鍵は、公開鍵と公開鍵の所有者を紐づける証明書の形で配布されている
        \item ハッシュ値の再計算：受け取ったデータをハッシュ関数に通し、ハッシュ値を再計算する
        \item 署名の検証：署名者の公開鍵を用いて複合したハッシュ値と再計算したハッシュ値を比較し、同じであれば検証が成功したと言える
    \end{enumerate}
\end{itemize}
\section{Verifiable CredentialsとDecentralized Identifiers}
本節では、デジタル証明書の一形態であるVerifiable Credentialsと、それを支える識別子であるDecentralized Identifiersについて解説した後、デジタル証明書の文脈で重要な機能である選択的開示と、アプリケーションとして欠かせないウォレットアプリケーションについても解説する。
\subsection{Verifiable Credentials}
前節で解説したデジタル証明書の一つの形態として、Verifiable Credentialsがある。
Verifiable CredentialsはW3Cが標準化を進めており、一般的にVerifiable CredentialsといえばW3Cによる``W3C VC''を指す。
Verifiable Credentialsはデジタル証明書そのものであり、Verifiable CredentialsのためのデータモデルとしてVerifiable Credentials Data Modelが存在する。
広義のVerifiable Credentialsとして、ISO/IEC 18013-5で定義されたmdoc/mDLや、IETFが標準化を進めるSD-JWT VCなども存在するが本稿では詳しくは触れない。
なお、Verifiable Credentialsは``VCs''、Verifiable Credentials Data Modelは``VCDM''と呼ばれることが一般的なため、本稿でもこれ以降この呼称を用いる。
\\
　VCsとは、検証可能な証明書のことであり、暗号学的な手法で改ざん検知、および正当に発行されたものであるかの検証を可能にしたクレデンシャルのことである。
クレデンシャルとは、発行者によって発行された、対象となる主体に対する何らかの主張（クレームと呼ばれる）の組と定義される。
例えば、髪が黒く、眼鏡をかけた男性がいた場合、クレームは「髪が黒い」「眼鏡をかけている」「男性である」の3つとなり、これをまとめたものがクレデンシャルとなる。
さらにこのクレデンシャルを暗号学的に改ざん検知、正当に発行されたものであるか検証できるようにしたものがVCs、といったイメージである。
\\
　VCsの基本的は構造は、発行者（Issuer）、保持者（Holder）、検証者（Verifier）という三者の役割分担を前提としている。
なお、この三者が登場するモデルはIHVモデルと呼ばれる。
VCsの発行から検証までの一連の流れは下記の通りである。
\begin{enumerate}
    \item 発行：発行者が特定の主体（Subjectと呼ばれる）に関するクレデンシャルを用意し、暗号学的な署名を施す。完成したら、Holderに送信する。多くの場合SubjectとHolderは一致するが、異なっても構わない
    \item 保持・提示：Issuerから送信されたVCsを受け取り、後述するウォレットアプリケーションなどに保持する。任意のタイミングでVerifierにVCsを提示する
    \item 検証：VerifierはHolderから送信されたVCsから検証に必要な公開鍵情報を取り出し、公開鍵を用意した上でVCsを検証する
\end{enumerate}
また、各主体はデータをVerifiable Data Registryと呼ばれるデータ保管場所とやり取りする。
一連の役割分担を示したのが下図である。
\begin{figure}[htbp]
    \includegraphics[width=150mm]{src/public/ecosystemofvc.png}
    \caption{VCsにおけるIHVモデル}
\end{figure}
\\
　また、Holderが複数のVCsを保持し、場合によってはまとめてVerifierに提示するユースケースがあることは容易に考えられる。
そのため、VCsには複数のVCsを合わせて提示するVerifiable Presentationsという形式も存在する。
Verifiable Presentationsには、そのVerifiable Presentationsが正しく構成されていることを示す証明と、提示者がHolderであることを示す証明が含まれる。
なお、Verifiable Presentationsも``VP''と一般的に呼ばれるため、本稿でもこれ以降この呼称を用いる。
\subsection{Decentralized Identifiers}
\subsection{選択的開示}
\subsection{ウォレットアプリケーション}
\section{本章のまとめ}